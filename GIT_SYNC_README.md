# Git同步功能使用说明

## 功能概述

Git同步功能允许你将待办事项数据同步到Git仓库中，实现跨设备的数据备份和同步。

## 主要特性

1. **默认关闭**: Git同步功能默认关闭，需要在设置中手动启用
2. **仓库初始化**: 支持指定Git仓库地址进行初始化
3. **按日期同步**: 数据按日期同步到 `sync/YYYY-MM-DD/store.json` 格式
4. **智能合并**: 自动比较本地和远程数据的更新时间，使用最新版本
5. **自动同步**: 支持每天自动同步功能
6. **手动同步**: 提供手动同步按钮

## 使用步骤

### 1. 启用Git同步

1. 打开应用设置
2. 找到"Git同步设置"部分
3. 开启"启用Git同步"开关

### 2. 配置仓库地址

1. 在"Git仓库地址"输入框中输入你的Git仓库URL
   - 例如: `https://github.com/username/repo.git`
   - 或者: `git@github.com:username/repo.git`

### 3. 初始化同步

1. 点击"初始化同步"按钮
2. 系统会自动克隆仓库到本地 `sync` 目录
3. 首次同步会创建当前日期的数据文件

### 4. 配置自动同步

1. 开启"自动同步"开关
2. 系统会每天检查并自动同步数据

### 5. 手动同步

1. 点击"手动同步"按钮
2. 系统会立即执行同步操作

## 数据同步逻辑

### 文件结构
```
sync/
├── 2025-01-15/
│   └── store.json
├── 2025-01-16/
│   └── store.json
└── ...
```

### 同步规则

1. **本地数据更新**: 如果本地 `todos.json` 的 `lastUpdate` 时间晚于远程对应日期的 `store.json`，则上传本地数据
2. **远程数据更新**: 如果远程 `store.json` 的 `lastUpdate` 时间晚于本地 `todos.json`，则下载远程数据
3. **冲突处理**: 如果发生合并冲突，系统会提示手动解决

### 时间比较

- 系统会比较 `lastUpdate` 字段来确定哪个版本更新
- 使用ISO 8601格式的时间戳进行比较
- 优先使用时间戳较新的版本

## 注意事项

1. **网络连接**: 同步需要网络连接，请确保网络畅通
2. **Git认证**: 私有仓库需要配置Git认证信息
3. **仓库权限**: 确保对目标仓库有读写权限
4. **数据备份**: 建议在启用同步前备份现有数据
5. **冲突处理**: 如果出现合并冲突，需要手动解决

## 故障排除

### 初始化失败
- 检查仓库地址是否正确
- 确认网络连接正常
- 验证Git认证信息

### 同步失败
- 检查仓库权限
- 确认本地Git配置正确
- 查看错误日志获取详细信息

### 数据不一致
- 手动执行同步操作
- 检查网络连接
- 必要时重新初始化同步

## 技术实现

- **后端**: 使用Rust的 `git2` 库进行Git操作
- **前端**: Vue 3 + TypeScript + Element Plus
- **数据格式**: JSON格式存储待办事项数据
- **时间处理**: 使用ISO 8601格式的时间戳

## 安全考虑

1. **认证信息**: Git认证信息存储在系统Git配置中
2. **数据加密**: 建议使用HTTPS或SSH协议传输数据
3. **权限控制**: 确保仓库访问权限设置正确
4. **数据隐私**: 注意不要在公开仓库中存储敏感信息
